using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using NUnit.Framework;
using NUnit.Framework.Legacy;
using Cern.Jet.Random.Engine;

namespace Cern.Colt.Tests
{
    [Parallelizable(ParallelScope.ContextMask)]
    public class RandomTest
    {
        [Test]
        public void Test1()
        {
            var RANDOM = new MersenneTwister((int)DateTime.UtcNow.CurrentTimeMillis());
            RANDOM.NextDouble();
            ClassicAssert.Pass();
        }

        [Test]
        public void MersenneTwisterLogicTest()
        {
            uint TEMPERING_MASK_B = 0x9d2c5680;
            uint TEMPERING_MASK_C = 0xefc60000;
            int y = 1810196533;
            int expected1 = 1810371736;
            int expected2 = -2076520;
            int expected3 = -677097320;
            int expectedFinal = -677091983;
            y ^= y >>> 11;
            ClassicAssert.AreEqual(y, expected1);

            y ^= (int)((uint)(y << 7) & TEMPERING_MASK_B);
            ClassicAssert.AreEqual(y, expected2);

            y ^= (int)((uint)(y << 15) & TEMPERING_MASK_C);
            ClassicAssert.AreEqual(y, expected3);

            y ^= y >>> 18;
            ClassicAssert.AreEqual(y, expectedFinal);
        }
        [Test]
        public void MersenneTwisterGeneragteBlockTest()
        {
            #region init
            int[] mt = new int[] { 4357, -1673174022, 708424086, -1410968015, -492255825, -1714499179, 204182333, -509101032, -2072352469, 893353746, 244040740, 370648639, 2131054055, 487707083, 1641703461, -2048763325, 1334806689, 1881048881, -2068576766, 1940225151, -1084519478, -1602376551, 685639353, 742434836, 402719740, 1869377157, -1299694034, -1280850133, -1089771227, 154646404, 684526386, 977349849, -1566190915, -1751009648, 209770120, 526085067, -498193861, 1793800825, 1247824254, 1976235586, 380765079, 88619452, -1601674410, -711018893, -611192728, 1726281152, 1142963795, 1850767497, 1106793944, -774242354, 946818183, -544313226, 1264382529, 420467573, 2140867167, 1095329101, -566320332, -109101232, -1867338683, 2037259266, -578574229, -84360799, 953018708, 1818690147, 1301832426, 41667064, 1605658394, -2095636246, 1892529960, -431147918, -548158489, -725316161, -27765880, 1303624252, -1438769317, 1463348836, 30219045, -747273498, -1488667605, -268320680, -1863287757, 893564210, -1029226740, 2112564018, 978015859, 841066164, 1214847322, -444222402, 1662069885, -839325371, -1626635844, 1674912357, -1824909872, -1549139325, 486533039, -1917055126, 1956191940, -448556774, 133385659, 1538506282, -1243870629, -769116290, 2012619851, 1133374361, 725240672, -805954231, 959699000, -642627965, 391219800, -1097028315, -1685855275, -113827738, -703063859, 227932459, -1833938583, 1056944390, 264703442, -1196698033, -27579317, -1791042949, -1645544719, 1768490596, -1818324141, -632064580, 1055221739, -1869888716, 250222128, 59404655, 1784424523, -1712226381, 75289571, 567874578, -1428124258, 171802725, 314357087, 1797023234, -2099193161, -650328234, -1661547465, 903282648, 1806010564, -404528314, 674748043, 1101334630, -429101005, 230680589, -197098829, -1716642929, 480680489, -111557694, -142775897, 2053269839, -1135588770, 870664377, 913289879, -691714770, -102986223, -378121853, -1474940022, 1423162979, 1427803978, 1496755256, 910914591, 230844382, -161822406, -740226722, -1533380821, -14943824, -511720237, -696916731, -2134741172, 848779493, -24403963, -233002929, -898709218, 1154486388, 1310202841, -1722706711, 2076217285, 2118425863, 1547971090, 200131892, 1204003386, 1436390654, -1025425325, 1600695189, -920000994, -679960704, -1484387881, 871960554, -231898608, 1593415434, -811959529, -293234615, 80040336, 1970224787, 727568990, -1171632677, 1688737375, -287628835, -379988430, 2089300906, -1827674559, -1061527514, 603075177, 2020021562, 598012949, -549025256, -694869005, -1690354291, -1119796431, -436976258, 318152377, -649289518, -655449449, 581862111, -1157891629, -1994422886, -1865691570, 1778305867, -212414706, -1937225486, -1333484390, 256873299, -1417573473, 483578918, 130025952, -1725118909, -345576075, -988402857, 296144686, 1307663373, 2127543716, -647166, 682542267, -648498766, 1761876557, 1757744361, 66994294, 789091709, -120725439, -1342884633, 1956741839, -296035783, -406266350, -127715210, 677513987, -139987930, 1208143509, -4934307, -887937820, 74507682, -891532314, -1960415270, -1460329678, 1090931067, 2133018658, -948227632, -704282483, 841370365, 271055829, -2074191602, 430788022, -940568619, -285852774, -306738718, 1956061051, 869119533, 2111960525, 1598301833, 2084175030, 673162306, 422650138, 449772115, 870592209, 164319880, 1310349500, 319629478, -1283727212, 2027298793, 48611232, -711902407, -294938312, 503188638, -900888206, 1790262206, 1286785657, 439097975, -623828717, 1765687357, -409766706, 866591864, 1925028988, -1057447050, 573297715, 1094648902, -1994936277, 1194556722, -1783254711, 242351710, 1353427522, -1649604452, 1288506584, -290114612, -215032753, 879510945, 1935778487, 9607425, 1220470681, 1382660141, -1334233454, -1813232429, 1294921465, -1171324655, 812350597, 598625972, 1926193728, 1663929826, 656176845, 1701418272, -2091024315, -2070644472, -1252006320, 984236265, 1413959217, -867595723, 2089522168, -317676668, -62238513, -1145123015, 440647373, 1366359340, -2125727475, 157534764, 851726506, 54840929, -1388423531, 268376968, -166091270, -1070517684, -57609229, 748039697, 1683900171, 914121289, -1951737563, -345995072, 1349764149, -15188513, 825407484, -446925879, -1509345108, -1706719559, 845797731, 1053671536, 1715002770, -704112798, -761934763, -500015753, -1613502194, 1782283799, 2056029718, -338413700, 589903897, 49775688, -1620461100, 704391679, 1022298633, 149735420, 72664028, 1027998525, 1996877187, 2013218749, 993979040, -171822443, 1932904008, 1934839108, 1293576881, -1185658647, 2086374541, -165060425, 2011324644, -1267873578, 1917594694, 95451266, -760537398, -747292566, 681737291, 111947290, 22027206, -1377702749, 1103456823, 1211354837, 1307316012, 2021397322, 441696545, 1766644880, -514613311, 590686211, -1300798019, 759675134, 1983769542, 806127124, -1019372682, -1942094688, 1055564714, -1781625433, 136495027, -1875808714, 83594624, 1954043161, -861180910, -1962724580, 1670367430, -1415727328, -1982361804, -1881760943, -67149397, -1387959099, 1728293609, 658544427, 1401858203, -474419097, -1131839330, 59417223, -60989461, 1197464973, -1791601178, -734071517, -1375926664, 1298082187, -829669600, -822382422, -1898706119, -775482572, -793046839, -592427007, -941848854, 1298007038, -2043409327, -1331114814, -1367976860, -2124669061, -378420429, -1103418825, -309335287, -1674974005, -701500761, 1403084151, -1343748274, 2052804401, -1917390926, -1298129985, -2117937047, 1366388568, 1841729763, -519168783, -984411058, -835602530, -238716657, -539120005, -171585824, -1726481912, -1233845796, -1329301703, -803178669, -804718163, -485137876, 1271607570, -882349, 142991281, -883033173, 109619963, 1212729823, -1512999825, 2047126287, 952368225, 436829473, -1315174174, -26051606, -786998488, 937499059, -1166741376, 1872333976, -1744741568, -153964838, -1286548866, 1056339302, -103159515, 1731702762, 2039098528, 164415087, -1257983306, -1904670892, -1980164353, 242382931, 1137894830, -1159182597, 528657898, -687417020, 1931697338, -961500485, 365562313, -932090045, 2077734947, -1366042270, -560416379, -674489828, -1347080310, 1514034112, -1414506974, 1515766218, 356981270, 1889342126, -742324212, 1932386273, -1660406429, 1836840693, 968688713, -656620589, -2125575325, 1108297977, -589528095, -415365152, 1864924486, -420123121, -959117891, 1034948632, 532362119, 270505299, 1554274000, 184753031, -1230627498, 492459612, 425676897, 591765851, -78684674, 979989885, 1843806570, -2100882351, 593405222, 650280986, -637503905, 30928446, -194892139, 2084264690, -943984896, -1427362371, 808243602, 1356059326, -1768726912, 1287268060, 810064984, 1320732896, 1552853998, 1708506741, -1251198481, 398671841, -2007064846, 1190049770, -402107162, 955638797, -932646830, 800573043, 500816018, -539585074, 1837244554, 1603157005, -2053890317, -1420115623, -28698340, 428381385, 134301320, 620207588, -1704177359, 930726121, -1650143444, -1999067366, -1353443275, -848619431, 37829825, -494451863, -1381453965, -429310233, 762841279, -29184861, 416424341, 99811091, 1625608138, 434275, -1255717796, -44451016, -606559278, -719948527, 503263287, -335775995, 8967925, -1380389379, 1086503044, -382403633, 10901831, -1403438501, 1142180210, 1031047097, 1571458904, -1301270151, 687062176, 1081806206, 1027492986, 265779330, -1290920021, -892469013, 667375943, -983680409, 1002000221, 589305623, 1571122554, 1547175663, -162390961, 1514407642, -1736513070, 369053128, -825116075, -902858624, 474050186 };
            int[] mt2 = new int[] { 756521470, -412369546, -1581505735, -1637795378, -438084095, 471917111, -1125244244, -438360096, -816762322, 258432417, 36834806, -1569612884, -470282973, 1699670239, 284864226, -1656701879, 177882215, -1953657803, 1863095729, -464346034, 1685260886, -1436280470, 828424993, 1603152229, 1292269562, -1513250935, -1018039859, 986733478, 63178319, -2125410177, 1343673232, 631726073, 110097091, -1999874972, 1482585488, 654028539, 1035615959, -175426442, -430623968, 1435318270, 1341792032, -1771028998, 1131357988, -1010914224, -231840357, 1382640837, 270247596, -848051739, -1262152916, 319874107, 2087085388, 1397673649, -271313324, 729012802, 185342406, -1361212941, 768536816, -1130924514, -1648815376, 1922724004, 709191569, -1381790299, 1894162325, -754319467, -1742070028, -1716571567, -1320163508, -1471763257, -483499116, 364131072, -1197357294, -2132893545, 1851523759, 1196049625, 1830084041, -777587566, -1939098340, -1330756155, 1086528589, -881200153, -348302725, -551426964, -1344090447, -1278475691, -1553718310, 1269628981, -1430027937, 508725307, 212080131, 1903408568, 289130696, 1856677122, -1319658178, -558135961, -1277512445, -197818314, -1151803790, -729584047, 1846229691, 957281033, 1989588565, 905280446, -873653847, -751988981, -1422280782, -1796701345, -838456387, -449110962, 1490968520, 50682665, -751910983, -1472532615, 1953634920, -905422431, 1245233813, 2004784199, 1453085684, -1794574053, 1319102593, -1165608110, 1292470139, 1209744037, -328732227, -2072687661, -728145285, -1605694216, -135924434, 1255394037, 1394936507, -427374282, 257407374, 91214748, -2135808451, -1688866313, -2094518697, -2061333544, 1975595978, -197757025, -1583078894, 263958815, 1578627273, 1339314123, 59515157, -1929639716, 97989254, -1560338504, 566072205, -1419729095, -82374943, 1213868465, -736799254, 1325135761, 1449740803, -830124216, 455753423, -1419886793, -1321389072, 836675504, 1175279105, 1028552772, -1530541842, -993804998, -286693623, 64520336, -1583844099, -453882567, 1649681482, 912377720, -1615830313, 535759787, 1171718750, 219652484, 508362212, 2092953670, 1785286322, -1695342377, 265038746, -745457708, 999174512, -1493519853, -1432159569, -292894396, 680523454, 1526682527, 1528056422, -1023554072, 1187268479, 881399959, 1093576288, 1021591067, 261620815, -1094505161, 1533884583, -1086647312, 2020052036, -1061643202, -1713199611, 10538229, -1360136508, -652998940, 1049010513, 2042345520, 1627089236, 1688769456, 2015871983, -1246868116, 1913244244, 1077022815, -60517703, -2016207815, 1338273477, -542865663, -1616359486, 1068622207, -275207945, 1093367377, 2134281616, 1799745584, -1336756224, 1704157544, -1340721098, 33969303, 1188139172, -1724434216, -2135371706, -909149072, -1981825676, -1725118909, -345576075, -988402857, 296144686, 1307663373, 2127543716, -647166, 682542267, -648498766, 1761876557, 1757744361, 66994294, 789091709, -120725439, -1342884633, 1956741839, -296035783, -406266350, -127715210, 677513987, -139987930, 1208143509, -4934307, -887937820, 74507682, -891532314, -1960415270, -1460329678, 1090931067, 2133018658, -948227632, -704282483, 841370365, 271055829, -2074191602, 430788022, -940568619, -285852774, -306738718, 1956061051, 869119533, 2111960525, 1598301833, 2084175030, 673162306, 422650138, 449772115, 870592209, 164319880, 1310349500, 319629478, -1283727212, 2027298793, 48611232, -711902407, -294938312, 503188638, -900888206, 1790262206, 1286785657, 439097975, -623828717, 1765687357, -409766706, 866591864, 1925028988, -1057447050, 573297715, 1094648902, -1994936277, 1194556722, -1783254711, 242351710, 1353427522, -1649604452, 1288506584, -290114612, -215032753, 879510945, 1935778487, 9607425, 1220470681, 1382660141, -1334233454, -1813232429, 1294921465, -1171324655, 812350597, 598625972, 1926193728, 1663929826, 656176845, 1701418272, -2091024315, -2070644472, -1252006320, 984236265, 1413959217, -867595723, 2089522168, -317676668, -62238513, -1145123015, 440647373, 1366359340, -2125727475, 157534764, 851726506, 54840929, -1388423531, 268376968, -166091270, -1070517684, -57609229, 748039697, 1683900171, 914121289, -1951737563, -345995072, 1349764149, -15188513, 825407484, -446925879, -1509345108, -1706719559, 845797731, 1053671536, 1715002770, -704112798, -761934763, -500015753, -1613502194, 1782283799, 2056029718, -338413700, 589903897, 49775688, -1620461100, 704391679, 1022298633, 149735420, 72664028, 1027998525, 1996877187, 2013218749, 993979040, -171822443, 1932904008, 1934839108, 1293576881, -1185658647, 2086374541, -165060425, 2011324644, -1267873578, 1917594694, 95451266, -760537398, -747292566, 681737291, 111947290, 22027206, -1377702749, 1103456823, 1211354837, 1307316012, 2021397322, 441696545, 1766644880, -514613311, 590686211, -1300798019, 759675134, 1983769542, 806127124, -1019372682, -1942094688, 1055564714, -1781625433, 136495027, -1875808714, 83594624, 1954043161, -861180910, -1962724580, 1670367430, -1415727328, -1982361804, -1881760943, -67149397, -1387959099, 1728293609, 658544427, 1401858203, -474419097, -1131839330, 59417223, -60989461, 1197464973, -1791601178, -734071517, -1375926664, 1298082187, -829669600, -822382422, -1898706119, -775482572, -793046839, -592427007, -941848854, 1298007038, -2043409327, -1331114814, -1367976860, -2124669061, -378420429, -1103418825, -309335287, -1674974005, -701500761, 1403084151, -1343748274, 2052804401, -1917390926, -1298129985, -2117937047, 1366388568, 1841729763, -519168783, -984411058, -835602530, -238716657, -539120005, -171585824, -1726481912, -1233845796, -1329301703, -803178669, -804718163, -485137876, 1271607570, -882349, 142991281, -883033173, 109619963, 1212729823, -1512999825, 2047126287, 952368225, 436829473, -1315174174, -26051606, -786998488, 937499059, -1166741376, 1872333976, -1744741568, -153964838, -1286548866, 1056339302, -103159515, 1731702762, 2039098528, 164415087, -1257983306, -1904670892, -1980164353, 242382931, 1137894830, -1159182597, 528657898, -687417020, 1931697338, -961500485, 365562313, -932090045, 2077734947, -1366042270, -560416379, -674489828, -1347080310, 1514034112, -1414506974, 1515766218, 356981270, 1889342126, -742324212, 1932386273, -1660406429, 1836840693, 968688713, -656620589, -2125575325, 1108297977, -589528095, -415365152, 1864924486, -420123121, -959117891, 1034948632, 532362119, 270505299, 1554274000, 184753031, -1230627498, 492459612, 425676897, 591765851, -78684674, 979989885, 1843806570, -2100882351, 593405222, 650280986, -637503905, 30928446, -194892139, 2084264690, -943984896, -1427362371, 808243602, 1356059326, -1768726912, 1287268060, 810064984, 1320732896, 1552853998, 1708506741, -1251198481, 398671841, -2007064846, 1190049770, -402107162, 955638797, -932646830, 800573043, 500816018, -539585074, 1837244554, 1603157005, -2053890317, -1420115623, -28698340, 428381385, 134301320, 620207588, -1704177359, 930726121, -1650143444, -1999067366, -1353443275, -848619431, 37829825, -494451863, -1381453965, -429310233, 762841279, -29184861, 416424341, 99811091, 1625608138, 434275, -1255717796, -44451016, -606559278, -719948527, 503263287, -335775995, 8967925, -1380389379, 1086503044, -382403633, 10901831, -1403438501, 1142180210, 1031047097, 1571458904, -1301270151, 687062176, 1081806206, 1027492986, 265779330, -1290920021, -892469013, 667375943, -983680409, 1002000221, 589305623, 1571122554, 1547175663, -162390961, 1514407642, -1736513070, 369053128, -825116075, -902858624, 474050186 };
            int[] mt3 = new int[] { 756521470, -412369546, -1581505735, -1637795378, -438084095, 471917111, -1125244244, -438360096, -816762322, 258432417, 36834806, -1569612884, -470282973, 1699670239, 284864226, -1656701879, 177882215, -1953657803, 1863095729, -464346034, 1685260886, -1436280470, 828424993, 1603152229, 1292269562, -1513250935, -1018039859, 986733478, 63178319, -2125410177, 1343673232, 631726073, 110097091, -1999874972, 1482585488, 654028539, 1035615959, -175426442, -430623968, 1435318270, 1341792032, -1771028998, 1131357988, -1010914224, -231840357, 1382640837, 270247596, -848051739, -1262152916, 319874107, 2087085388, 1397673649, -271313324, 729012802, 185342406, -1361212941, 768536816, -1130924514, -1648815376, 1922724004, 709191569, -1381790299, 1894162325, -754319467, -1742070028, -1716571567, -1320163508, -1471763257, -483499116, 364131072, -1197357294, -2132893545, 1851523759, 1196049625, 1830084041, -777587566, -1939098340, -1330756155, 1086528589, -881200153, -348302725, -551426964, -1344090447, -1278475691, -1553718310, 1269628981, -1430027937, 508725307, 212080131, 1903408568, 289130696, 1856677122, -1319658178, -558135961, -1277512445, -197818314, -1151803790, -729584047, 1846229691, 957281033, 1989588565, 905280446, -873653847, -751988981, -1422280782, -1796701345, -838456387, -449110962, 1490968520, 50682665, -751910983, -1472532615, 1953634920, -905422431, 1245233813, 2004784199, 1453085684, -1794574053, 1319102593, -1165608110, 1292470139, 1209744037, -328732227, -2072687661, -728145285, -1605694216, -135924434, 1255394037, 1394936507, -427374282, 257407374, 91214748, -2135808451, -1688866313, -2094518697, -2061333544, 1975595978, -197757025, -1583078894, 263958815, 1578627273, 1339314123, 59515157, -1929639716, 97989254, -1560338504, 566072205, -1419729095, -82374943, 1213868465, -736799254, 1325135761, 1449740803, -830124216, 455753423, -1419886793, -1321389072, 836675504, 1175279105, 1028552772, -1530541842, -993804998, -286693623, 64520336, -1583844099, -453882567, 1649681482, 912377720, -1615830313, 535759787, 1171718750, 219652484, 508362212, 2092953670, 1785286322, -1695342377, 265038746, -745457708, 999174512, -1493519853, -1432159569, -292894396, 680523454, 1526682527, 1528056422, -1023554072, 1187268479, 881399959, 1093576288, 1021591067, 261620815, -1094505161, 1533884583, -1086647312, 2020052036, -1061643202, -1713199611, 10538229, -1360136508, -652998940, 1049010513, 2042345520, 1627089236, 1688769456, 2015871983, -1246868116, 1913244244, 1077022815, -60517703, -2016207815, 1338273477, -542865663, -1616359486, 1068622207, -275207945, 1093367377, 2134281616, 1799745584, -1336756224, 1704157544, -1340721098, 33969303, 1188139172, -1724434216, -2135371706, -909149072, -1981825676, -1045667941, 484972546, -378583890, 563160855, -628850477, 601616950, 1907486766, -915177671, 584814551, -1576178934, 63778253, 754803149, 1184255452, -1413692813, -207429798, 862282122, 2038311790, -138670066, -1573576465, -545169827, -1720001085, 213316379, 1424576851, 498490292, 1751667209, -530667420, -1758764972, -1017393212, 1012245086, -1561507689, -1575181559, -440612264, -1751859210, -1964803869, 344511307, -1676994098, 1254171418, -2091847545, 85331010, -714908617, -402500327, 551198305, 2104744319, -676233615, -21564138, -972644045, -1864302309, -912889695, -1815593102, 446066792, 1708889350, -1238535782, -291059324, -1733036287, 2084164954, -534605892, 149435465, -909251647, 585680659, -427504320, -1641723961, 1077157220, 1127163378, -1965396567, -1586179894, -1177328662, 2035465610, -1999032604, 2125269854, 1982696857, 729001833, -941203528, 1175050126, 1235009687, 192043941, -419664524, 1827957732, 1938872266, -528777783, 1379405752, 1449824616, 1864206501, -1210165768, 1664258275, 1560011897, -810405790, 1811845058, 260419425, 902014755, 1088779081, -1682095247, 1545498514, 703720899, -1661879837, -378190293, 812128413, 141806005, 1806637972, 273609543, 260481739, -1850003731, -249385731, 532968976, -74059363, 848624619, -799447479, -681311256, 2106706849, -683031459, 1157289709, -400396988, -937265569, -1825385650, 88866422, -518041137, -179825220, -901673031, -524763781, -1079068092, 469931362, 361815173, -474106978, -1084002837, 1348417616, 346373653, -1087509312, -990274585, 1641529668, -1553507250, 244799314, 1086213385, -377824184, -1108056778, -1363154359, 1270088324, -2074523140, 2054549280, 968938431, 651892681, 198038241, 1547538727, -931135862, -1593415925, 772479965, 407390166, 18265645, 1478979753, -1832320613, 1150454630, -839336678, 858792819, -320342251, 764967537, -726422749, 1644964076, -1450835082, -1737966443, 1482963845, -1957373701, 1041788745, -1536310003, 1262222260, 386097869, -1094068443, -2022804629, -657701732, -160074747, 46639408, 907091432, -679661707, -974913441, 1538555387, 626132999, 1689891660, 1274512137, -588390777, 1354332751, 1082048984, -426254730, -1360919288, -388023185, 1304318743, 249184439, 528402961, 718515717, -684517768, 36667621, -362093088, -1512462742, -212977498, -451845660, 879482493, -341648331, 401595164, 639847435, 410353058, 1053079855, -100166932, -1535714249, 704892074, 1752703597, -2044945366, 1203599044, 64302053, -1505397076, -582105866, -2091060497, -1218280320, -1618292276, -511959610, -707340238, -2014256800, -929864208, -434676195, 36239793, -2025958507, -1862678325, -1134971254, 1112404364, -1790214388, -1478345839, -433896496, 1074456445, 1500480984, 1498483885, -1585984548, 640959962, 1747181884, 2118226469, -1904763039, -1065669809, 744679217, 1496913222, 1027214634, -1840644137, -474938220, 1393942652, -222174780, 1568133339, 594793813, 223163909, 786989149, -1883034496, -1556951348, 1251001406, 701835783, 999013125, 471044908, -1732575916, 1277646114, 1653564993, 14942109, 581342306, -1978591212, -1265170040, 810881022, -645652486, -72037834, -1161301781, 846265275, -109531370, 676185371, 31836710, 1346599489, -999525587, -656263198, 189976769, -907335730, -1532621373, 850562954, -63827245, -2027463861, 2086028465, 1124906272, 1957064671, 1999328188, 232758489, -1818265317, -573866860, -1183031743, -173220127, 1776418379, -1928401063, 38517058, -243047786, 185090837, 102404719, 162131369, -1350478143, -956754167, 1069333663, 2027636132, 1104967497, -835433307, -79287020, 154744317, -597718463, -787374744, -1723967564, -790823278, -660882719, 622883021, 2054508648, 2007459151, 1027472612, 1977378086, -627937334, 1808613271, -1423867196, -2127727283, -78009836, 223655658, -590122897, -537525198, 1332631678, -1762000714, 1056497200, -1201621775, -1872705133, 1910998282, -1265086276, -499324565, 1446317043, 274171801, 1291026404, 1040819888, -1536897746, 302351045, 600540114, 468400489, -1729975704, 110154136, 355148944, -212829247, -1287481273, -643487724, 1796316170, -1629258495, 2129516678, 149974248, -907137531, -1640342207, 545582855, -834589443, -222071927, 730866179, -558447159, 457358099, -1479417837, 1908527406, -1344142173, -863170390, 392625579, 187006081, -1947472152, 1825827022, -1463897636, -1780486884, 1921717022, -1920597293, 934546087, 1361551530, -84568992, 395951817, -901555736, -248758515, -1489282628, -2056172926, 1202403499, -1050199223, -2087069979, -1055663190, -1909285921, 976049168, 360444568, 1783090378, 1304958329, 1732902179, -858099286, 856120396, -749201566, -494692378, 1441379292, 1384358121, -473721239, 1333841802, -1233071075, -1967164496, -64010212, -1256006603, -739519416, -1957623934, -1842093448, 1209342448, 1741690224, 2016520877, 474050186 };
            #endregion

            int y;
            int kk;
            uint UPPER_MASK = 0x80000000;
            uint LOWER_MASK = 0x7fffffff;
            int N = 624;
            int M = 397;
            int mag0 = 0x0;
            uint mag1 = 0x9908b0df;
            int expectedY = 756521470;
            int expected_mtN1 = -1040784502;
            double expectedRaw = 0.17614138079807162;

            for (kk = 0; kk < N - M; kk++)
            {
                y = (int)(((uint)mt[kk] & UPPER_MASK) | ((uint)mt[kk + 1] & LOWER_MASK));
                mt[kk] = mt[kk + M] ^ (y >>> 1) ^ ((y & 0x1) == 0 ? mag0 : (int)mag1);
            }

            ClassicAssert.AreEqual(mt, mt2);

            for (; kk < N - 1; kk++)
            {
                y = (int)(((uint)mt[kk] & UPPER_MASK) | ((uint)mt[kk + 1] & LOWER_MASK));
                mt[kk] = (int)((uint)mt[kk + (M - N)] ^ (y >>> 1) ^ ((y & 0x1) == 0 ? mag0 : mag1));
            }

            ClassicAssert.AreEqual(mt, mt3);

            y = (int)((mt[N - 1] & UPPER_MASK) | (mt[0] & LOWER_MASK));

            ClassicAssert.AreEqual(y, expectedY);

            mt[N - 1] = (int)(mt[M - 1] ^ (y >>> 1) ^ ((y & 0x1) == 0 ? mag0 : mag1));

            ClassicAssert.AreEqual(mt[N - 1], expected_mtN1);

            Double d = (y & 0xFFFFFFFFL) * 2.3283064365386963E-10;

            ClassicAssert.AreEqual(d, expectedRaw);
        }
    }
}
